<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Inferiority Wordle</title>
        <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <link href="bootstrap.min.css" rel="stylesheet">
                    <link rel="preconnect" href="https://fonts.googleapis.com">
                        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                            <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&family=Ubuntu+Mono&display=swap" rel="stylesheet">        <link href="styles.css" rel="stylesheet">
                                    <link href="styles.css" rel="stylesheet">
                                        </head>
                                        <body>
                                            <header th:replace="fragments.html :: header"/>
                                            <section>
                                                <div class="textdiv"> 
                                                    <h3 class="result">You took <span th:text="${userScore[0][0]}"></span> guess<span th:if="${userScore[0][1] > 1}">es</span> and <span th:text="${userScore[0][1]}"></span> second<span th:if="${userScore[0][1] > 1}">s</span> to guess <span th:text="${word}"></span></h3>
                                                </div>
                                                <div class="chartWithMarkerOverlay">
                                                    <div id="chart_div" class="jschart"></div>
                                                    <div class="overlay-marker">
                                                        <span class="dot"></span>
                                                    </div>
                                                </div>
                                                <a href="/newgame"><button type="button" class="btn btn-primary">Try again</button></a>
                                            </section>
                                            <footer th:replace="fragments.html :: footer"/>

                                            <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                                            <script type="text/javascript"  th:inline="javascript">
                                                google.charts.load('current', {packages: ['corechart', 'scatter']});
                                                google.charts.setOnLoadCallback(drawChart);
                                                function drawChart() {
                                                var data = new google.visualization.DataTable();
                                                data.addColumn('number', 'Guesses');
                                                data.addColumn('number', 'Time');
                                                data.addRows([[${scores}]]);
                                                data.addRows([[${userScore}
                                                ]]);
                                                var options = {
                                                hAxis: {title: 'Time (seconds)', titleTextStyle: {color: '#fff', fontSize: 20}, minValue: 0, format: 'decimal', textStyle: {color: '#fff', fontSize: 15}},
                                                        vAxis: {title: 'Guesses', titleTextStyle: {color: '#fff', fontSize: 20}, minValue: 0, maxValue: 6, format: 'decimal', textStyle: {color: '#fff', fontSize: 15}},
                                                        legend: 'none',
                                                        backgroundColor: '#222',
                                                        font: 'Ubuntu Mono',
                                                        chartArea: {
                                                        backgroundColor: '#222',
                                                                width: 780,
                                                                height: 400,
                                                                top: 10
                                                        },
                                                        color: '#3498db',
                                                        pointSize: 9
                                                };
                                                function placeMarker(dataTable) {
                                                var cli = this.getChartLayoutInterface();
                                                var chartArea = cli.getChartAreaBoundingBox();
                                                document.querySelector('.overlay-marker').style.top = Math.floor(cli.getYLocation(dataTable.getValue(dataTable.getNumberOfRows() - 1, 1))) - 11 + "px";
                                                document.querySelector('.overlay-marker').style.left = Math.floor(cli.getXLocation(dataTable.getValue(dataTable.getNumberOfRows() - 1, 0))) - 6 + "px";
                                                }
                                                ;
                                                var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));
                                                google.visualization.events.addListener(chart, 'ready',
                                                        placeMarker.bind(chart, data));
                                                //google.visualization.events.addListener(chart, 'ready', function () {
                                                //chart_div.innerHTML = '<img src="' + chart.getImageURI() + '">';
                                                //});
                                                chart.draw(data, options);
                                                }
                                            </script>
                                        </body>
                                        </html>
